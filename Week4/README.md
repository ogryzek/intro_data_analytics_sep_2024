# Week 4  
- [11. Common Table Expressions](#11-common-table-expressions) 
- [12. Data Retrieval](#12-data-retieval)

## 11. Common Table Expressions  
### Part 1: CTE (Common Table Expressions)  
  
1. Write a query that defines a CTE named `"Sales_CTE"`, which is based on the `OrderHeader` table, and contains the following columns:  Order Number, SalesPersonID, the year in which the order was placed.  

  Analyze only the data that has a value in the SalesPersonID column. Use the CTE you defined, and write a query that shows the amount of orders that each salesperson generated each year. 
  
  Sort the query results by SalesPersonID and year.  
  
  Note: With the results of the query, it is possible to evaluate the salespeople's performance, and see whether the salesperson improved their performance or it needs to be strengthened.  
  
  In addition, take into account when examining the results that data is not provided for all the months in 2011 and 2014.

2. Write a query that shows the average number of orders for all the years, for all the sales people. Analyze only the data that has a value in the SalesPersonID column:  
  a. Define a CTE named "Sales_CTE", which is based on the Order header table, and contains the following columnsSalesPersonID, the amount of orders generated by the salesperson.  
  b. WriteaquerybasedontheCTEthatdisplaystheaverageorderquantityof all the salespeople.  
    
3. WriteaquerythatdefinesaCTEnamed"Person_CTE",whichisbasedonthe Sales.Customer and Person.Person tables and contains the following columns: CustomerID, first name and last name.  
  
  The purpose of the CTE is to make it easier for us to link the Sales.SalesOrderHeader table to the Person.Person table.  
  
  Use the Order header table and the Person_CTE that you defined to write a query that displays the order number, customer number, first name, last name, and SubTotal.

4. Write a query that displays the amount of orders per product color in 2013,sorted from highest to lowest. Use a CTE to simplify the query:  

  a. Define a CTE named "Sales_CTE", which contains the following columns: Order number, OrderDate, ProductID and OrderQty.  
  
  b. UsetheCTEandtheProducttabletodisplaytheamountofordersper product color in 2013, sorted from highest to lowest  
  
  c. Note: The query could also be solved without using a CTE. However, it helps to keep the code clean, tidy and legible when splitting the queries into parts.  
    
### Part 2: Multiple CTE's (Common Table Expressions)  
## 12. Data Retieval  
